(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{283:function(t,e,n){"use strict";n.r(e);n(29),n(30),n(92),n(11),n(9),n(13),n(25),n(111),n(23);var r,o=n(24),c=n(35),l=n(49),d=n(55),m=n(39),f=n(183),v=n(47);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(m.a)(t);if(e){var o=Object(m.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var y=Object(f.Component)({methods:Object(v.b)(["fetchArticles"])})(r=function(t){Object(l.a)(n,t);var e=h(n);function n(){var t;Object(o.a)(this,n);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(t=e.call.apply(e,[this].concat(c))).article={},t.errors=[],t.inProgress=!1,t.API_BASE_URL="https://satyendra.online/api/",t.IMAGES_BASE_URL="https://storage.googleapis.com/cupitor-220103.appspot.com",t}return Object(c.a)(n,[{key:"beforeRouteLeave",value:function(t,e,n){return confirm("Are you sure you want to leave?")?(localStorage.setItem("articleEditing",window.CKEDITOR.instances.editor.getData()),n()):n(!1)}},{key:"mounted",value:function(){var t=this;console.log("mounted");var e=document.createElement("script");e.async=!1,e.src="/ckeditor/ckeditor.js",document.head.append(e),window.onload=function(e){window.CKEDITOR.replace("editor",{entities:!0,extraPlugins:"mathematica,codesnippet",allowedContent:!0}),t.setupEditor(),fetch(t.API_BASE_URL+"article/"+t.$route.params.id).then((function(t){return t.json()})).then((function(article){t.article=article,setTimeout((function(){CKEDITOR.instances.editor.setData(t.article.content)}),1e3)}))}}},{key:"setupEditor",value:function(){window.onbeforeunload=function(){return localStorage.setItem("articleEditing",window.CKEDITOR.instances.editor.getData()),"Are you sure you want to leave?"};var t=window.CKEDITOR.instances.editor,e=!1,n=!1;t.on("key",(function(t){17==t.data.domEvent.$.keyCode&&(e=!1)})),t.on("key",(function(t){if((e=17==t.data.domEvent.$.keyCode||t.data.domEvent.$.metaKey||t.data.domEvent.$.ctrlKey)||(e=t.metaKey||t.ctrlKey),e&&"s"==t.key&&(n=!0),n||83==t.data.domEvent.$.keyCode&&1==e){try{t.data.domEvent.$.preventDefault()}catch(t){}try{document.getElementById("publishArticleButton").click()}catch(t){}return e=!1,n=!1,!1}})),window.document.addEventListener("keydown",(function(t){if((window.navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)&&83==t.keyCode){t.preventDefault();try{document.getElementById("publishArticleButton").click()}catch(t){}}}),!1)}},{key:"validate",value:function(){console.log(this.article);var t={};return this.article.name||(t.title=["Can't be empty"]),this.article.subject||(t.subject=["Can't be empty"]),this.errors=t,0==Object.keys(t).length}},{key:"onPreview",value:function(){var t=this.article.name,e=this.article.subject,summary=this.article.summary;this.$store.dispatch("articlePreview",{content:CKEDITOR.instances.editor.getData(),name:t,subject:e,summary:summary})}},{key:"onPublish",value:function(t){var e=this;if(this.validate()&&(window["X-Auth"]||(window["X-Auth"]=prompt("Enter auth header"),window["X-Auth"]))){this.article.content=window.CKEDITOR.instances.editor.getData();var n=t?"PUT":"POST",r=t?this.API_BASE_URL+"article/"+t:this.API_BASE_URL+"article";this.inProgress=!0,fetch(r,{method:n,body:JSON.stringify(this.article),headers:{"X-Auth":window["X-Auth"],"Content-Type":"application/json"}}).then((function(t){return e.inProgress=!1,t.json()}))}}},{key:"head",value:function(){var t=this;return{title:this.article?this.article.name:"LivingToLearn",script:[{hid:"mathjax",src:"/ckeditor/ckeditor.js",defer:!0,callback:function(){t.isStripeLoaded=!0}}]}}}]),n}(f.Vue))||r,w=n(54),component=Object(w.a)(y,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor-page"},[n("div",{staticClass:"container page"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-10 offset-md-1 col-xs-12"},[n("form",{on:{submit:function(e){return e.preventDefault(),t.onPublish(t.article.id)}}},[n("fieldset",{attrs:{disabled:t.inProgress}},[n("fieldset",{staticClass:"form-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.article.name,expression:"article.name"}],staticClass:"form-control form-control-lg",attrs:{type:"text",placeholder:"Article Title"},domProps:{value:t.article.name},on:{input:function(e){e.target.composing||t.$set(t.article,"name",e.target.value)}}})]),t._v(" "),n("fieldset",{staticClass:"form-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.article.subject,expression:"article.subject"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Subject"},domProps:{value:t.article.subject},on:{input:function(e){e.target.composing||t.$set(t.article,"subject",e.target.value)}}})]),t._v(" "),n("fieldset",{staticClass:"form-group"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.article.content,expression:"article.content"}],staticClass:"form-control",attrs:{id:"editor",name:"editor",rows:"8",placeholder:"Write your article (in markdown)"},domProps:{value:t.article.content},on:{input:function(e){e.target.composing||t.$set(t.article,"content",e.target.value)}}})]),t._v(" "),n("fieldset",{staticClass:"form-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.article.summary,expression:"article.summary"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Description"},domProps:{value:t.article.summary},on:{input:function(e){e.target.composing||t.$set(t.article,"summary",e.target.value)}}})])]),t._v(" "),n("button",{staticClass:"btn btn-lg pull-xs-left btn-primary",attrs:{disabled:t.inProgress,id:"publishArticleButton",type:"submit"}},[t._v("\n            Publish Article\n          ")]),t._v(" "),n("span",{staticClass:"btn btn-lg pull-xs-right btn-primary",attrs:{disabled:t.inProgress},on:{click:function(e){return t.onPreview()}}},[t._v("\n            Preview\n          ")])])])])]),t._v(" "),n("br"),n("br")])}),[],!1,null,null,null);e.default=component.exports}}]);